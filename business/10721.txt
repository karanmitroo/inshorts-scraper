The BSE Sensex and NSE Nifty on Thursday ended with marginal gains, with the Sensex gaining 34.62 points to settle at 27,201.49 while the Nifty rising by 1.95 points to close at 8,337.90. Lupin, Hindustan Unilever, ITC and HDFC were among the top gainers while Tata Steel, TCS, Infosys and Coal India were among the major losers.